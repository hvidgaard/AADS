sourcedir				:= src
output					:= debug
Ccompileroptions		:= -Wall -std=c99 -O2
Cppcompileroptions		:= -Wall -O2
includes				:= -I./$(sourcedir)
outputfile				:= p2_vebt

objectfiles				:= BinaryHeap.o FibonacciHeap.o vebtrees.o main.o graph_generators.o benchmark.o dijkstra.o misc.o rb_int_key.o red_black_tree.o stack.o veb_pq.o

prebuild:
	mkdir -p $(output)

build: $(objectfiles)
	gcc ./$(output)/main.o ./$(output)/BinaryHeap.o ./$(output)/FibonacciHeap.o ./$(output)/vebtrees.o -o ./$(output)/$(outputfile) ./$(output)/graph_generators.o ./$(output)/benchmark.o ./$(output)/dijkstra.o ./$(output)/misc.o ./$(output)/rb_int_key.o ./$(output)/red_black_tree.o ./$(output)/stack.o ./$(output)/veb_pq.o -lm -lstdc++

all: prebuild build

clean:
	rm -f ./$(output)/BinaryHeap.o
	rm -f ./$(output)/FibonacciHeap.o
	rm -f ./$(output)/misc.o
	rm -f ./$(output)/veb_pq.o
	rm -f ./$(output)/rb_int_key.o
	rm -f ./$(output)/red_black_tree.o
	rm -f ./$(output)/stack.o
	rm -f ./$(output)/vebtrees.o
	rm -f ./$(output)/main.o
	rm -f ./$(output)/graph_generators.o
	rm -f ./$(output)/benchmark.o
	rm -f ./$(output)/dijkstra.o
	rm -f ./$(output)/$(outputfile)

veb_pq.o: ./$(sourcedir)/veb_pq.c ./$(sourcedir)/veb_pq.h
	gcc $(Ccompileroptions) $(includes) -c $< -o ./$(output)/$@
	
dijkstra.o: ./$(sourcedir)/dijkstra.c ./$(sourcedir)/dijkstra.h
	gcc $(Ccompileroptions) $(includes) -c $< -o ./$(output)/$@

BinaryHeap.o: ./$(sourcedir)/BinaryHeap.c ./$(sourcedir)/BinaryHeap.h
	gcc $(Ccompileroptions) $(includes) -c $< -o ./$(output)/$@

benchmark.o: ./$(sourcedir)/benchmark.cpp ./$(sourcedir)/benchmark.h
	gcc $(Cppcompileroptions) $(includes) -c $< -o ./$(output)/$@

FibonacciHeap.o: ./$(sourcedir)/FibonacciHeap.c ./$(sourcedir)/FibonacciHeap.h
	gcc $(Ccompileroptions) $(includes) -c $< -o ./$(output)/$@

vebtrees.o: ./$(sourcedir)/vebtrees.c ./$(sourcedir)/vebtrees.h
	gcc $(Ccompileroptions) $(includes) -c $< -o ./$(output)/$@
	
main.o: ./$(sourcedir)/main.c
	gcc $(Ccompileroptions) $(includes) -c $< -o ./$(output)/$@

graph_generators.o: ./$(sourcedir)/graph_generators.c ./$(sourcedir)/graph_generators.h
	gcc $(Ccompileroptions) $(includes) -c $< -o ./$(output)/$@

misc.o: ./$(sourcedir)/RBTree/misc.c ./$(sourcedir)/RBTree/misc.h
	gcc $(Ccompileroptions) $(includes) -c $< -o ./$(output)/$@

rb_int_key.o: ./$(sourcedir)/RBTree/rb_int_key.c ./$(sourcedir)/RBTree/rb_int_key.h
	gcc $(Ccompileroptions) $(includes) -c $< -o ./$(output)/$@

red_black_tree.o: ./$(sourcedir)/RBTree/red_black_tree.c ./$(sourcedir)/RBTree/red_black_tree.h
	gcc $(Ccompileroptions) $(includes) -c $< -o ./$(output)/$@

stack.o: ./$(sourcedir)/RBTree/stack.c ./$(sourcedir)/RBTree/stack.h
	gcc $(Ccompileroptions) $(includes) -c $< -o ./$(output)/$@